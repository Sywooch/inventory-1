Система Инвентаризации Склада
=============================

Что это такое?
--------------
Это довольно простое веб-приложение, написанное на PHP5 и MySQL, позволяющее автоматизировать складское хранение товаров. Однако, написано оно было прежде всего в личных целях для домашнего использования. Приложение написано с использованием Yii Framework 2.0 на базе Advanced Application Template.

У меня дома довольно много разных вещей. По своей природе я немного забывчив, так что иногда я помню, что покупал какую-то вещь, но совершенно не представляю где она может лежать. На её поиски у меня может уйти несколько часов и без результата. Кроме того, я иногда покупаю какие-то вещи повторно просто потому что забыл, что уже покупал их или не помню где они лежат. Мне иногда проще купить их снова, чем искать их. В результате моя квартира со временем заполнилась вещами, распиханным по разным шкафам, стеллажам, ящикам. И чем больше вещей становилось, тем труднее становилось найти среди них то, что нужно. Разумеется, я пытался систематизировать хранение по вещей по категориям, но это не всегда помогает.

Чтобы решить эти проблемы я решил организовать у себя дома ячеистое хранение вещей, создав данную программу. Благодаря ей все мои вещи были пронумерованы, им присвоены уникальные идентификаторы. Некоторые вещи могут быть контейнерами, в этом случае они могут содержать в себе другие вещи рекурсивно. В результате образуется древовидная структура, ветви которой представляют собой путь для поиска нужного предмета. В корне дерева находятся: квартира, машина, дача. Квартира содержит комнаты, коридор, лоджию. Те в свою очередь содержат шкафы, которые делятся на секции, полки, коробочки и так далее. Если мне нужно найти какую-то вещь, я ввожу буквально несколько букв, которые как я предполагаю есть в её названии, описании или в метках, и мгновенно получаю путь к ней. Например: Квартира → Лоджия → Правый стеллаж → Полка 3 → Большая компьютерная коробка → Коробка с компьютерными мелочами → Переходник с DVI на HDMI черный.

Каждая вещь или контейнер содержит название, произвольное описание, несколько меток (тегов), перечисленных через запятую, и несколько фотографий. Метки помогают искать вещи. В метки я добавляю синонимы названия предмета, материал, цвет. Поиск реализован не по целым словам, а по подстроке (SQL LIKE). Это позволяет искать шире, вводя в поиск меньше букв. Хотя и требует немного больше ресурсов.

Несколько скриншотов приложения: https://yadi.sk/d/YnH35Xn6mpcJP

Требования
----------

Проект будет работать на PHP версии 5.6+ и MySQL/MariaDB 5.5+. Веб-сервер может быть любой, но основной упор делается на nginx и Apache. Возможна также работа и на более старых версиях PHP и MySQL, но я не могу точно сказать какие версии являются минимально допустимыми. Операционная система роли не играет.

Установка
---------

1\. Слить себе репозитарий через:
```
git clone https://github.com/gugglegum/inventory.git
cd inventory
```
2\. Запустить скрипт `init` (linux) или `init.bat` (windows), который сгенерирует файлы index.php и локальные конфиги.

3\. Создать пустую базу данных MySQL и отдельного пользователя, если необходимо.

4\. Отредактируйте файл `common/config/main-local.php`, прописав в нём правильные параметры подключения к созданной вами базе данных.

5\. Установите Composer, если он у вас ещё не установлен. Можно установить его локально в каталог приложения, например, командой:
`php -r "readfile('https://getcomposer.org/installer');" | php`. Другие варианты и опции установки [здесь](https://getcomposer.org/download/).

6\. Запустите `composer.phar install`. Это установит Yii Framework и прочие зависимости в папку `vendor`.

7\. Примените все миграции командой `yii migrate`. Эта команда создаст в созданной вами базе данных необходимые таблицы.

8\. Настройте веб-сервер (nginx, apache) таким образом, чтобы корнем www-директории считался подкаталог `backend/web`, а все запросы, кроме `/css/\*`, `/images/\*` и `/js/\*` перенаправлялись на `public/index.php`. Вот пример рабочего конфига для nginx:

```
    server {
        listen       80;
        server_name  inventory.dev;

        # Inventory application path
        set $app_dir D:/Users/Pavel/inventory;

        root $app_dir/backend/web;

        location / {
            try_files $uri @index-php;
            gzip            on;
            gzip_types      text/css application/javascript;
            expires         2w;
        }

        location /photos {
            alias $app_dir/photos;
        }

        location ~ \.php$ {
            include                 fastcgi_params;
            fastcgi_pass            127.0.0.1:9000;
            fastcgi_index           index.php;
            fastcgi_param           SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        }

        location @index-php {
            rewrite                 ^/(.*)$ /index.php last;
        }
    }
```
По большому счёту в этом примере нужно заменить только путь к директории, где находится приложение.

9\. Если вы запускаете приложение на локальной машине, добавьте запись о локальном домене в `/etc/hosts` (в Windows `%systemroot%\system32\drivers\etc\hosts`). Например:

```
127.0.0.1 inventory.dev
```

10\. Создайте директорию `photos` в корне приложения и обеспечьте возможность создания в ней поддиректорий пользователем, под которым выполняется PHP-процесс при работе веб-приложения.

11\. Если вы всё сделали правильно, то приложение должно открываться в браузере по адресу http://inventory.dev/. Первым делом оно попросит вас авторизоваться. Поскольку в системе ещё нет ни одного пользователя, его нужно создать. В веб-приложении есть раздел управления пользователями, но в него нужно сперва попасть. Поэтому первого пользователя нужно создать вручную. Сделать это можно специальной консольной командой, например, так: `yii user/create admin admin@example.com`. Вам предложат ввести пароль для нового в консоли или во всплывающем окне.

Советы по использованию
-----------------------

Для быстрого добавления предметов в базу можно воспользоваться функцией импорта. На странице просмотра каждого контейнера внизу есть текстовое поле, куда можно построчно ввести наименования предметов и они все разом добавятся в базу. Можно задать описание предмета, если в следующей за наименованием строке начать строку с "!". Чтобы задать теги строку следует начать с символа "@". Признак контейнера можно задать так: "* container: 1" или "* контейнер: 1". Под текстовым полем имеется галочка "Подтвердить добавление", которая по умолчанию снята. Нажатие кнопки Импорт со снятой галочкой показывает страницу предпросмотра, на которой можно в наглядной форме увидеть что именно будет добавлено.

Обратная связь
--------------
Если у вас возникли какие-либо вопросы или трудности с установкой — смело обращайтесь ко мне по адресу [gugg...@gmail.com](http://www.google.com/recaptcha/mailhide/d?k=01sX4Ace0VIjf560E7EVd9VA==&c=uEyB5Ixp45PEYVFxFEFlnitY5hRz4yNXpGygDIKOvF4=) (решите каптчу, чтобы увидеть е-мейл адрес полностью).
